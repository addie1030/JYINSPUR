<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="view_account_asset_asset_form_inherit" model="ir.ui.view">
        <field name="name">account.asset.asset.form</field>
        <field name="model">account.asset.asset</field>
        <field name="inherit_id" ref="account_asset.view_account_asset_asset_form"/>
        <field name="arch" type="xml">
            <xpath expr="//button[@name='set_to_close']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='account_analytic_id']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='date_first_depreciation']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='first_depreciation_manual_date']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//field[@name='depreciation_line_ids']/tree/field[@name='move_check']" position="attributes">
                <attribute name="invisible">1</attribute>
            </xpath>
            <xpath expr="//button[@name='compute_depreciation_board']" position="replace">
                <button type="object" name="compute_depreciation_board" string="Compute Depreciation" attrs="{'invisible': ['|', ('ps_is_depreciation', '=', False), ('state', '!=', 'draft')]}"/>
            </xpath>
            <xpath expr="//field[@name='state']" position="before">
                <button type="object" name="generate_account_move" string="Generate Account Move"
                        attrs="{'invisible': ['|', '&amp;',('move_id', 'in', [None,False]),('state','not in','open'),('move_id', 'not in', [None,False])]}"/>
            </xpath>
            <xpath expr="//field[@name='invoice_id']" position="after">
                <field name="category_id"/>
                <field name="ps_is_depreciation" invisible="1"/>
                <field name="ps_asset_state_id" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
            </xpath>
            <xpath expr="//field[@name='code']" position="before">
                <field name="name"/>
            </xpath>
            <xpath expr="//field[@name='name']" position="replace"/>
            <xpath expr="//field[@name='currency_id']" position="replace"/>
            <xpath expr="//field[@name='category_id']" position="replace"/>
            <xpath expr="//field[@name='date']" position="replace"/>
            <xpath expr="//field[@name='value']" position="replace"/>
            <xpath expr="//field[@name='salvage_value']" position="replace"/>
            <xpath expr="//field[@name='value_residual']" position="replace"/>
            <xpath expr="//field[@name='partner_id']" position="replace"/>
            <xpath expr="//field[@name='invoice_id']" position="replace"/>
            <xpath expr="//header[1]/button[5]" position="replace">
                <button name="%(account_asset.action_asset_modify)d" states="11" string="Modify Depreciation" type="action"/>
            </xpath>
            <xpath expr="//page[1]" position="before">
                <page string="Base Information">
                    <group>
                        <group>
                            <field name="ps_change_mode_id" attrs="{'readonly': [('state', '!=', 'draft')]}" domain="[('category', 'ilike','add')]"/>
                            <field name="ps_change_mode_category" invisible="1"/>
                            <field name="partner_id" string="Vendor" attrs="{'invisible': [('ps_change_mode_category', '!=', 'add')]}"/>
                            <field name="invoice_id" readonly="1" attrs="{'invisible': [('ps_change_mode_category', '!=', 'add')]}"/>
                            <field name="ps_asset_uom_id"/>
                            <field name="ps_asset_quantity" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                            <field name="method_number" string="Number of Depreciation"/>
                            <field name="ps_plan_months" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                            <field name="create_card_date" widget="date"/>
                            <field name="date" string="Depreciate Start Date" readonly="1"/>
                            <field name="move_id" readonly="1"/>
                        </group>
                        <group>
                            <field name="value"/>
                            <field name="ps_depreciation_amount" attrs="{'invisible': [('state', '!=', 'open')]}"/>
                            <field name="ps_init_amount" attrs="{'invisible': [('state', '!=', 'draft')]}"/>
                            <field name="salvage_value"/>
                            <field name="value_residual"/>
                            <field name="ps_accrued_months"/>
                            <field name="ps_monthly_amount"/>
                            <field name="ps_asset_barcode"/>
                            <field name="ps_location_id" attrs="{'readonly': [('state', '!=', 'draft')]}"/>
                            <field name="currency_id" groups="base.group_multi_currency"/>
                        </group>
                    </group>
                    <notebook name="Department" style="width:50%" groups="analytic.group_analytic_accounting">
                        <page string="Department">
                            <field name="ps_department_ids" mode="tree">
                                <tree editable="bottom">
                                    <field name="ps_analytic_id"/>
                                    <field name="ps_proportional"/>
                                </tree>
                                <form>
                                    <group>
                                        <group>
                                            <field name="ps_analytic_id"/>
                                        </group>
                                        <group>
                                            <field name="ps_proportional"/>
                                        </group>
                                    </group>
                                </form>
                            </field>
                        </page>
                    </notebook>
                </page>
            </xpath>
            <xpath expr="//page[3]" position="after">
                <page string="Alteration Information">
                    <field name="ps_alteration_line_ids" mode="tree" domain="[('asset_id', '=', id)]">
                        <tree editable="bottom" create="false" delete="false">
                            <field name="alteration_id"/>
                            <field name="asset_id" invisible="1"/>
                            <field name="asset_code" invisible="1"/>
                            <field name="cause"/>

                            <field name="former_value"/>
                            <field name="latter_value"/>
                            <field name="former_depreciation"/>
                            <field name="latter_depreciation"/>

                            <field name="former_category_id"/>
                            <field name="latter_category_id"/>
                            <field name="former_location_id"/>
                            <field name="latter_location_id"/>

                            <field name="former_asset_state_id"/>
                            <field name="latter_asset_state_id"/>
                            <field name="former_quantity"/>
                            <field name="latter_quantity"/>

                            <field name="former_salvage_value" invisible="1"/>
                            <field name="latter_salvage_value" invisible="1"/>
                            <field name="former_method_number"/>
                            <field name="latter_method_number"/>

                        </tree>
                    </field>
                </page>

                <page string="Disposal Information">
                    <field name="ps_disposal_line_ids" mode="tree" domain="[('asset_id', '=', id)]">
                        <tree editable="bottom" create="false" delete="false">
                            <field name="disposal_id"/>
                            <field name="abstract"/>
                            <field name="depreciation_month"/>
                            <field name="income"/>
                            <field name="expense"/>
                        </tree>
                    </field>
                </page>
            </xpath>
        </field>
    </record>

    <menuitem id="menu_account_asset_root"
              name="Asset"
              web_icon="ps_account_asset,static/description/icon.png"
              groups="account.group_account_manager"/>

    <menuitem id="menu_account_asset_adviser"
              name="Management"
              parent="menu_account_asset_root"
              sequence="1"/>

    <menuitem id="menu_account_asset_report"
              name="Reports"
              parent="menu_account_asset_root"
              sequence="2"/>

    <menuitem id="menu_account_asset_configuration"
              name="Configuration"
              parent="menu_account_asset_root"
              sequence="3"/>

    <record id="account_asset.menu_asset_depreciation_confirmation_wizard" model="ir.ui.menu">
        <field name="groups_id" eval="[(3,ref('base.group_no_one'))]"/>
    </record>

    <record model ="ir.ui.menu" id ="account_asset.menu_asset_depreciation_confirmation_wizard">
        <field name ="parent_id" ref="menu_account_asset_adviser" />
    </record>

    <record model ="ir.ui.menu" id ="account_asset.menu_action_asset_asset_report">
        <field name ="name">Asset Analysis</field>
        <field name ="parent_id" ref="menu_account_asset_report" />
    </record>

    <record model ="ir.ui.menu" id ="account_asset.menu_action_account_asset_asset_list_normal_purchase">
        <field name ="parent_id" ref="menu_account_asset_configuration" />
    </record>

    <record model ="ir.ui.menu" id ="account_asset.menu_action_account_asset_asset_form">
        <field name ="name">Asset Cards</field>
        <field name ="parent_id" ref="menu_account_asset_adviser" />
    </record>

    <record model ="ir.ui.menu" id ="account_asset.menu_finance_config_assets">
        <field name ="parent_id" ref="menu_account_asset_configuration" />
    </record>

    <record model="ir.actions.act_window" id="account_asset.action_account_asset_asset_form">
        <field name="help" type="html">
          <p class="oe_view_nocontent_create">
            Click to create a new asset.
          </p>
        </field>
    </record>

    <!--为使新翻译生效需删除旧翻译-->
    <delete model="ir.translation" search="[('src','=','Generate Assets Entries'),('name','=','ir.ui.menu,name')]"/>
    <delete model="ir.translation" search="[('src','=','Depreciation Entries: Asset Account'),('name','=','ir.model.fields,field_description'),('module','=','account asset')]"/>

    <record model="ir.ui.menu" id="account_asset.menu_asset_depreciation_confirmation_wizard">
        <field name="name">Record Depreciation</field>
    </record>

</odoo>