<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <!--结算方式-->
        <record id="view_account_bankpayment_list" model="ir.ui.view">
            <field name="name">ps.account.bankpayment.list</field>
            <field name="model">ps.account.bankpayment</field>
            <field name="arch" type="xml">
                <tree toolbar="1">
                    <field name="name"/>
                    <field name="shortcode"/>
                </tree>
            </field>
        </record>
        <record id="ps_account_bankpayment_form_view" model="ir.ui.view">
            <field name="name">ps.account.bankpayment.form</field>
            <field name="model">ps.account.bankpayment</field>
            <field name="arch" type="xml">
                <form>
                    <sheet>
                        <group>
                            <group>
                                <field name="name"/>
                            </group>
                            <group>
                                <field name="shortcode"/>
                            </group>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>
        <record id="ps_account_bankpayment_action" model="ir.actions.act_window">
            <field name="name">Settlement method</field>
            <field name="res_model">ps.account.bankpayment</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_account_bankpayment_list"/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a new billing method.
                </p>
            </field>
        </record>
        <menuitem id="menu_ps_account_account_bankpayment"
                  name="Settlement method"
                  parent="account.account_account_menu"
                  action="ps_account_bankpayment_action"
                  sequence="0"
                  groups="account.group_account_manager"/>

        <!--Fixed Rate-->
        <record id="view_account_currency_fixed_rate_list" model="ir.ui.view">
            <field name="name">ps_res_currency_fixed_rate_list</field>
            <field name="model">ps.res.currency.fixed.rate</field>
            <field name="arch" type="xml">
                <tree string="Fixed exchange rate" toolbar="1" editable="top">
                    <field name="name" placeholder="Two-digit month"/>
                    <field name="account_rate"/>
                    <field name="adjust_rate"/>
                </tree>
            </field>
        </record>
        <act_window
                id="act_view_currency_fixed_rates"
                name="Fixed Rates"
                view_mode='tree,form'
                view_id='view_account_currency_fixed_rate_list'
                domain="[('currency_id','=', active_id)]"
                context="{'default_currency_id': active_id}"
                res_model="ps.res.currency.fixed.rate"/>

        <!--币种页面改造，增加固定汇率按钮，增加汇率方式字段-->
        <record id="view_ps_account_currency" model="ir.ui.view">
            <field name="name">res.currency.form</field>
            <field name="model">res.currency</field>
            <field name="inherit_id" ref="base.view_currency_form"/>
            <field name="arch" type="xml">
                <xpath expr="//button[@name='%(base.act_view_currency_rates)d']" position="replace">
                    <button class="oe_stat_button" string="Floating Rates" type="action" name="%(base.act_view_currency_rates)d"
                            icon="fa-money" widget="statinfo" attrs="{'invisible': ['|', ('active', '=', False),('ps_rate_style','=','1')]}"/>
                </xpath>
                <xpath expr="//button[@name='toggle_active']" position="before">
                    <button class="oe_stat_button" string="Fixed Rates" type="action" name="%(act_view_currency_fixed_rates)d"
                            icon="fa-money" widget="statinfo" attrs="{'invisible': ['|', ('active', '=', False),('ps_rate_style','=','2')]}"/>
                </xpath>

                <xpath expr="//field[@name='rate']" position="after">
                    <!--<group string="Exchange Rate Style">-->
                    <field name="ps_rate_style"/>
                    <!--</group>-->
                </xpath>
                <xpath expr="//field[@name='currency_subunit_label']" position="after">
                    <!--<group string="Exchange Rate Style">-->
                    <field name="ps_rate_compute_style"/>
                    <!--</group>-->
                </xpath>
            </field>
        </record>
        <!--期末结账-->
        <record id="ps_account_period_end_action" model="ir.actions.server" >
            <field name="name">Period-end closing</field>
            <field name="model_id" ref="account.model_account_move"/>
            <field name="type">ir.actions.server</field>
            <field name="state">code</field>
            <field name="code">
                env['account.move'].ps_period_end_handle('201805')
            </field>
        </record>
        <!--期末损益结转-->
        <record id="ps_account_balance_transfer_action" model="ir.actions.server" >
            <field name="name">Profit and loss carryover</field>
            <field name="model_id" ref="account.model_account_move"/>
            <field name="type">ir.actions.server</field>
            <field name="state">code</field>
            <field name="code">
                action=env['account.move'].create_profit_loss_move()
            </field>
        </record>

        <record id="action_month_check" model="ir.actions.client">
            <field name="name">Period-end closing</field>
            <field name="tag">month.homepage</field>
        </record>
        <menuitem name="Period-end closing"
                  id="menu_month_check"
                  parent="menu_accounting_month_end"
                  sequence="10"
                  action="action_month_check"
                  groups="account.group_account_manager"
        />

        <record id="action_loss_account" model="ir.actions.client">
            <field name="name">Profit and loss carryover</field>
            <field name="tag">loss.homepage</field>
        </record>
        <menuitem name="Profit and loss carryover"
                  id="menu_loss_account"
                  parent="menu_accounting_month_end"
                  sequence="1"
                  action="action_loss_account"
                  groups="account.group_account_manager"
        />

        <record id="view_account_move_no_process_form" model="ir.ui.view">
            <field name="name">ps.account.move.no.process.form</field>
            <field name="model">ps.account.move.no.process</field>
            <field name="arch" type="xml">
                <form string="Document break number processing" create="false" edit="false" cancel="false" delete="false">
                    <sheet>
                        <group>
                            <field name="period_id" options="{'no_open': True, 'no_create': True}"/>
                            <field name="journal_id" options="{'no_open': True, 'no_create': True}"/>
                        </group>
                        <group>
                            <field name="no_process_style" widget="radio"/>
                        </group>
                        <button name="get_move_records"
                                string="Refresh"
                                type="object"
                                default_focus="1"
                                class="btn-primary "
                                style="margin-right:5px">
                        </button>
                        <button name="handle_move_records"
                                string="Start organizing"
                                type="object"
                                class="btn-primary">
                        </button>
                        <!--<button string="Confirm Invoices" name="invoice_confirm" type="object" default_focus="1" class="btn-primary"/>-->
                        <field name="move_ids" widget="one2many_list">
                            <tree  delete="false" create="false">
                                <field name="no_process_style" invisible="1" />
                                <field name="old_no" string="Original document number" />
                                <field name="new_no" string="New document number" />
                                <field name="move_date" string="Document date" attrs="{'invisible': [('no_process_style', '=', '0')]}"/>
                            </tree>
                        </field>
                    </sheet>
                </form>
            </field>
        </record>
        <record id="ps_account_move_no_process_action" model="ir.actions.act_window">
            <field name="name">Break number processing</field>
            <field name="res_model">ps.account.move.no.process</field>
            <field name="view_type">form</field>
            <field name="view_mode">form</field>
            <!--<field name="view_id" ref="view_account_move_no_process_form"/>-->
            <field name="context">{'form_no_edit':False,'form_no_create':False}</field>
        </record>
        <menuitem name="Break number processing"
                  id="menu_account_move_no_handle"
                  parent="menu_accounting_month_end"
                  sequence="2"
                  action="ps_account_move_no_process_action"
                  groups="account.group_account_manager"
        />
    </data>

</odoo>
