<?xml version="1.0" encoding="utf-8"?>
<templates xml:space="preserve">

	<!--样表功能菜单栏-->
	<t t-name="spreadsheets_menuBar">
		<div name='journaling_toolsBar' id='journaling_toolsBar' class="journaling_toolsBar">
			<section class="left">
				<button id='btnPrint' class="btn btn-primary btn-sm">打印预览</button>
				<button id='btnSave' class="btn btn-primary btn-sm">保存套表</button>
				<button id='btnSaveastemplate' class="btn btn-primary btn-sm">存为模板</button>
				<button id='btnLoadtemplate' class="btn btn-primary btn-sm">读取模板</button>
				<button id='btnAddSheet' class="btn btn-primary btn-sm">新增样表</button>
				<button id='btnDelReport' class="btn btn-primary btn-sm">删除当前样表</button>
				<button id='btnColumnDefine' class="btn btn-primary btn-sm">列定义</button>
				<button id='btnReportProperties' class="btn btn-primary btn-sm">报表属性</button>

				<button id='btnValidateRules' class="btn btn-info btn-sm">校验规则</button>
				<div class="btn-group">
					<button class="btn btn-info btn-sm">对齐方式</button>
					<button class="btn btn-info btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						<span class="caret" />
						<span class="sr-only">Toggle Dropdown</span>
					</button>
					<ul class="dropdown-menu">
						<li><a id="alignleft">左对齐</a></li>
						<li><a id="aligncenter">居中</a></li>
						<li><a id="alignright">右对齐</a></li>
						<li role="separator" class="divider" />
						<li><a id="aligntop">顶端对齐</a></li>
						<li><a id="alignvetically">垂直居中</a></li>
						<li><a id="alignbottom">底端对齐</a></li>
						<li role="separator" class="divider" />
						<li><a id="wordwrap">自动换行</a></li>
					</ul>
				</div>
				<div class="btn-group">
					<button class="btn btn-info btn-sm">边框</button>
					<button class="btn btn-info btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						<span class="caret" />
						<span class="sr-only">Toggle Dropdown</span>
					</button>
					<ul class="dropdown-menu">
						<li><a id="noborder">无边框</a></li>
						<li><a id="allborder">所有边框</a></li>
						<li role="separator" class="divider" />
						<li><a id="thinline">细框线</a></li>
						<li><a id="wideline">粗框线</a></li>
						<li role="separator" class="divider" />
						<li><a id="wideline">显示网格线</a></li>
						<li><a id="wideline">隐藏网格线</a></li>
					</ul>
				</div>
				<div class="btn-group">
					<button class="btn btn-info btn-sm">格式</button>
					<button class="btn btn-info btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						<span class="caret" />
						<span class="sr-only">Toggle Dropdown</span>
					</button>
					<ul class="dropdown-menu">
						<li><a id="common_format">常规</a></li>
						<li><a id="numerical_format">数值</a></li>
						<li><a id="currency_format">货币</a></li>
						<li><a id="account_format">会计专用</a></li>
						<li><a id="date_format">日期</a></li>
						<li><a id="text_format">文本</a></li>
						<li role="separator" class="divider" />
						<li><a>自定义</a></li>
					</ul>
				</div>
			</section>
		</div>
	</t>

	<!--GcSpread 容器模板-->
	<t t-name="journaling_template">

		<t t-call="spreadsheets_menuBar" />

		<div class="journaling_tutorial">
			<div class="options">
				<div class="option-row">
					<!--Jax fx 功能去掉-->
					<!--<button id='btnFormulaGuide' class="btnFormulaGuide" type="button">fx</button>-->
					 <div id="formulaBar" contenteditable="true" spellcheck="false">

					 </div>
				</div>
			</div>
			<div class="journaling_spreadsheets" id="ss">
			</div>

			<t t-call="spreadContextMenu" />
		</div>
	</t>

	<!-- spread 右键菜单按钮组 -->
	<t t-name="spreadContextMenu">
		<ul id="spreadContextMenu" class="dropdown-menu" role="menu">
			<li><a class="localize" id="bold">加粗</a></li>
			<li><a class="localize" id="italic">斜体</a></li>
			<li class="context-2 divider" />
			<li><a class="localize" id="cut">剪切</a></li>
			<li><a class="localize" id="copy">复制</a></li>
			<li><a class="localize" id="paste">粘贴</a></li>
			<li><a class="localize" id="merge">合并单元格</a></li>
			<li><a class="localize" id="unmerge">取消合并</a></li>
			<li class="context-1 divider" />
			<li><a class="localize" id="cleardata">清除内容</a></li>
			<li><a class="localize" id="clearformula">清除公式</a></li>
			<li><a class="localize" id="clearstyle">清除格式</a></li>
			<li><a class="localize" id="clearall">全部清除</a></li>
			<li class="context-2 divider" />
			<li><a class="localize" id="insertrow">插入行</a></li>
			<li><a class="localize" id="insertcol">插入列</a></li>
			<li><a class="localize" id="deleterow">删除行</a></li>
			<li><a class="localize" id="deletecol">删除列</a></li>
		</ul>
	</t>

	<!--公式定义信息-->
	<t t-name="JournalingFormulaDefineInfo">
		<div>
			<div id="FormulaDefineInfoone">
				<div class="col-md-4">
					<div class="form-group">
						<label for="formula_option">公式选择</label>
						<select name="formula_option" id="formula_option" placeholder="公式选择" class="form-control">
							<t t-foreach="data" t-as="d">
								<option t-att-value="d['id']"><t t-raw="d['name']"/></option>
							</t>
						</select>
					</div>
				</div>
				<div class="col-md-3">
					<div class="form-group">
						<label for="formula_symbol">运算符号</label>
						<select class="form-control" name="formula_symbol" id="formula_symbol">
							<option value="+">+</option>
							<option value="-">—</option>
						</select>
					</div>
				</div>
				<div class="col-md-4">
						<div class="form-group">
							<label for="button">&amp;nbsp;&amp;nbsp;</label>
							<div>
								 <button name="button" class="btn btn-sm btn-primary" id="add">添加公式</button>
							</div>
						</div>
					</div>
			</div>
			<div>
				<div class="col-md-8">
					<div class="form-group">
						<label for="formula_summary">使用说明及示列</label>
						<input type="text" class="form-control" name="formula_summary" id="formula_summary" placeholder="使用说明及示列"/>
					</div>
				</div>
				<div class="col-md-4">
					<div class="form-group">
							<label for="formula_summary">作用范围</label>
							<input type="text" class="form-control" name="formula_Range" id="formula_Range"/>
						</div>
				</div>

			</div>

			<div id="FormulaDefineInfotwo">
				<t t-foreach="data[0]['formula_params_ids']" t-as="d">
					<div class="col-md-4 formula_params_ids">
						<div class="form-group">
							<span><t t-raw="d['name']"/></span>
							<input type="text" class="form-control" t-att-index="d['id']"/>
						</div>
					</div>
				</t>
			</div>
		</div>
	</t>

	<!--样表属性-->
	<t t-name="JournalingProperties">

		<div class="report-properties">
			<div class="col-md-6">
				<div class="form-group">
					<label for="report_name">报表名称</label>
					<input type="text" class="form-control" required="required" name="report_name" id="report_name" placeholder="资产负债表" t-att-value="data['name']" />
				</div>
				<div class="form-group">
					<label for="uom">单位</label>
					<select class="form-control" name="uom" id="uom">
						<option value="yuan" t-att-selected="(data['uom'] === 'yuan' ? 'selected' : null)">元</option>
						<option value="million-yuan" t-att-selected="(data['uom'] === 'million-yuan' ? 'selected' : null)">万元</option>
					</select>
				</div>
				<div class="form-group">
					<label for="coloffset">列偏移</label>
					<em>  多列报表请设定偏移值</em>
					<div class="input-group">
						<input type="number" required="required" class="form-control" name="coloffset" id="coloffset" t-att-value="data['col_offset'] || 0" />
						<div class="input-group-addon">列</div>
					</div>
				</div>

				<div class="checkbox">
					<label>
						<input type="checkbox" name="protected" t-att-checked="(data['is_protected'] === true ? 'checked' : null)" />
						锁定报表
					</label>
				</div>
			</div>

			<div class="col-md-6">
				<div class="form-group">
					<label for="rowcount">行总数</label>
					<div class="input-group">
						<input type="number" min="1" required="required" class="form-control" name="rowcount" id="rowcount" t-att-value="data['row_count']" />
						<div class="input-group-addon">行</div>
					</div>
				</div>
				<div class="form-group">
					<label for="columncount">列总数</label>
					<div class="input-group">
						<input type="number" min="1" required="required" class="form-control" name="columncount" id="columncount" t-att-value="data['column_count']" />
						<div class="input-group-addon">列</div>
					</div>
				</div>
				<div class="form-group">
					<label for="titlerows">标题行数</label>
					<div class="input-group">
						<input type="number" min="1" required="required" class="form-control" name="titlerows" id="titlerows" t-att-value="(data['head_count'])" />
						<div class="input-group-addon">行</div>
					</div>
				</div>
				<div class="form-group">
					<label for="tailrows">表尾行数</label>
					<div class="input-group">
						<input type="number" min="0" required="required" class="form-control" name="tailrows" id="tailrows" t-att-value="data['tail_count']" />
						<div class="input-group-addon">行</div>
					</div>
				</div>
			</div>

		</div>

	</t>

	<!--样表列信息-->
	<t t-name="JournalingColumnInfo">
		<div class="row">
			<div class="col-md-6">
				<t t-foreach="data" t-as="d">
					<div class="form-group">
						<label for="col_index">列编号</label>
						<input type="text" class="form-control" t-att-index="d['col_index']" name="col_index" placeholder="1" t-att-value="d['col_index']" />
					</div>
				</t>
			</div>

			<div class="col-md-6">
				<!--<t t-debug="pdb" />-->
				<t t-foreach="data" t-as="j">
					<div class="form-group ">
						<label for="col_define">列定义</label>
						<select class="form-control" t-att-name="'col_define_' + j['col_index']" t-att-index="j['col_index']">
							<t t-foreach="o_items" t-as="o">
								<option t-att-value="o['id']" t-att-selected="j['col_type'] == o['id'] ? 'selected' : null"><t t-raw="o['name']"/></option>
							</t>
						</select>
					</div>
				</t>
			</div>
		</div>
	</t>

	<!--设置单元格格式-->
	<t t-name="JournalingCellFormatter">
		<div class="o_row cell_formatter">
			<div class="col-md-6">
				<div class="form-group">
					<t t-set="selected" t-value="" />
					<label for="uom">对齐方式</label>
					<select class="form-control" name="align">
						<option value="left">左对齐</option>
						<option value="middle">居中对齐</option>
						<option value="right">右对齐</option>
					</select>
				</div>
			</div>

			<div class="col-md-6">
				<div class="form-group">
					<label for="tailrows">格式化</label>
					<input type="text" class="form-control" name="formatter" placeholder="0.00" />
				</div>
			</div>
		</div>
	</t>

	<!--保存模板模态框-->
	<t t-name="JournalingTemplateDialog">
		<div class="o_row journaling_template">
			<div class="form-group">
				<label for="template_name">模板名称</label>
				<input type="text" class="form-control" required="required" name="template_name" />
			</div>
			<p class="text-danger" />
		</div>
	</t>

	<t t-name="JournalingTemplateLoadDialog">
		<div class="o_row">
			<table class="table table-bordered">
				<thead>
					<th>模板名称</th>
					<th>保存时间</th>
					<th>操作</th>
				</thead>
				<tbody>
					<t t-foreach="data" t-as="t">
						<tr>
							<td><t t-raw="t['name']"/></td>
							<td><t t-raw="t['storage_time']"/></td>
							<td t-att-id="t['id']">
								<button type="button" class="btn btn-primary btn-xs">加载</button>
							</td>
						</tr>
					</t>
				</tbody>
			</table>
		</div>
	</t>

	<!--公式校验-->
	<t t-name="ValidateRulesTableTr">
		<t t-foreach="data" t-as="o">
			<!--<t t-debug="pdb" />-->
			<tr>
				<td><t t-raw="o['index']"/></td>
				<td><t t-raw="o['value']"/> </td>
				<td>
					<button type="button" class="btn btn-primary btn-xs" id="modify_validate_rule">编辑</button>
					<button type="button" class="btn btn-primary btn-xs" id="update_validate_rule">更新</button>
					<button type="button" class="btn btn-danger btn-xs" id="del_validate_rule">删除</button>
				</td>
			</tr>
		</t>
	</t>

	<t t-name="ValidateRulesDialog">
		<div class="o_row validate_rules">

			<div class="o_row">
				<textarea class="form-control rule-area" name="rule" rows="3"/>
				<span id="helpBlock" class="help-block">示例：资产负债表!B5=资产负债表!B4+资产负债表!B5-资产负债表!B7</span>
			</div>

			<div class="o_row validate_rules_table">
				<table class="table table-bordered">
					<thead>
						<th>#</th>
						<th>规则</th>
						<th>操作</th>
					</thead>
					<tbody>
						<t t-call="ValidateRulesTableTr" />
					</tbody>
				</table>
			</div>

		</div>
	</t>

</templates>
